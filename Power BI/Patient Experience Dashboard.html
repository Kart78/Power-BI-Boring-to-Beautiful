<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Patient Experience Dashboard</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #003049 0%, #001d3d 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #003566 0%, #001d3d 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .tabs {
            display: flex;
            background: #f5f5f5;
            border-bottom: 2px solid #ddd;
            overflow-x: auto;
        }

        .tab {
            padding: 15px 25px;
            cursor: pointer;
            border: none;
            background: none;
            font-size: 1rem;
            font-weight: 600;
            color: #666;
            transition: all 0.3s;
            white-space: nowrap;
        }

        .tab:hover {
            background: #e0e0e0;
        }

        .tab.active {
            background: white;
            color: #003566;
            border-bottom: 3px solid #003566;
        }

        .tab-content {
            display: none;
            padding: 30px;
            animation: fadeIn 0.5s;
        }

        .tab-content.active {
            display: flex;
            gap: 20px;
        }

        .filter-sidebar {
            min-width: 200px;
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            height: fit-content;
            position: sticky;
            top: 20px;
        }

        .filter-sidebar h3 {
            font-size: 1.1rem;
            margin-bottom: 20px;
            color: #003566;
            font-weight: 600;
        }

        .filter-group {
            margin-bottom: 20px;
        }

        .filter-label {
            font-size: 0.85rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
            display: block;
        }

        .filter-select {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 8px;
            background: white;
            color: #333;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .filter-select:hover {
            border-color: #003566;
        }

        .filter-select:focus {
            outline: none;
            border-color: #003566;
            box-shadow: 0 0 0 3px rgba(0,53,102,0.1);
        }

        .content-area {
            flex: 1;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .kpi-card {
            background: linear-gradient(135deg, #577590 0%, #277da1 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }

        .kpi-card:hover {
            transform: translateY(-5px);
        }

        .kpi-card.green {
            background: linear-gradient(135deg, #43aa8b 0%, #90be6d 100%);
        }

        .kpi-card.red {
            background: linear-gradient(135deg, #d62828 0%, #f94144 100%);
        }

        .kpi-card.amber {
            background: linear-gradient(135deg, #f77f00 0%, #fcbf49 100%);
        }

        .kpi-card.blue {
            background: linear-gradient(135deg, #003566 0%, #4d908e 100%);
        }

        .kpi-label {
            font-size: 0.9rem;
            opacity: 0.9;
            margin-bottom: 10px;
        }

        .kpi-value {
            font-size: 2.5rem;
            font-weight: bold;
        }

        .kpi-subtitle {
            font-size: 0.85rem;
            opacity: 0.8;
            margin-top: 5px;
        }

        .chart-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 25px;
            margin-top: 20px;
        }

        .chart-container {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .chart-title {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 20px;
            color: #333;
        }

        .demo-note {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 10px;
            padding: 20px;
            margin: 20px;
            text-align: center;
        }

        .demo-note h3 {
            color: #856404;
            margin-bottom: 10px;
        }

        .demo-note p {
            color: #856404;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üè• Patient Experience Dashboard</h1>
            <p>Comprehensive Healthcare Analytics | Demo Version</p>
        </div>

        <div class="tabs">
            <button class="tab active" data-tab="overview">üìä Executive Overview</button>
            <button class="tab" data-tab="access">‚è±Ô∏è Access & Wait Times</button>
            <button class="tab" data-tab="cost">üí∞ Cost & Billing</button>
            <button class="tab" data-tab="satisfaction">üòä Patient Satisfaction</button>
        </div>

        <div id="overview" class="tab-content active">
            <div class="filter-sidebar">
                <h3>üîç Filters</h3>
                
                <div class="filter-group">
                    <label class="filter-label">Year</label>
                    <select class="filter-select filter-year" id="yearFilter" multiple>
                        <option value="all" selected>All Years</option>
                        <option value="2023">2023</option>
                        <option value="2024">2024</option>
                        <option value="2025">2025</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label class="filter-label">Specialty</label>
                    <select class="filter-select filter-specialty" id="specialtyFilter" multiple>
                        <option value="all" selected>All Specialties</option>
                        <option value="cardiology">Cardiology</option>
                        <option value="orthopedics">Orthopedics</option>
                        <option value="neurology">Neurology</option>
                        <option value="oncology">Oncology</option>
                        <option value="pediatrics">Pediatrics</option>
                        <option value="primary">Primary Care</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label class="filter-label">Region</label>
                    <select class="filter-select filter-region" id="regionFilter" multiple>
                        <option value="all" selected>All Regions</option>
                        <option value="northeast">Northeast</option>
                        <option value="southeast">Southeast</option>
                        <option value="midwest">Midwest</option>
                        <option value="southwest">Southwest</option>
                        <option value="west">West</option>
                    </select>
                </div>
            </div>
            
            <div class="content-area">
                <div class="demo-note">
                    <h3>üìã Demo Dashboard</h3>
                    <p>This is a demonstration version with sample data. In production, this would load your CSV files and display real patient experience metrics.</p>
                </div>

                <div class="kpi-grid">
                    <div class="kpi-card green">
                        <div class="kpi-label">Average HCAHPS Score</div>
                        <div class="kpi-value">8.4</div>
                        <div class="kpi-subtitle">Out of 10</div>
                    </div>
                    <div class="kpi-card amber">
                        <div class="kpi-label">Avg Wait Time</div>
                        <div class="kpi-value">12</div>
                        <div class="kpi-subtitle">Days to Appointment</div>
                    </div>
                    <div class="kpi-card blue">
                        <div class="kpi-label">Avg Out-of-Pocket</div>
                        <div class="kpi-value">$487</div>
                        <div class="kpi-subtitle">Per Patient</div>
                    </div>
                    <div class="kpi-card red">
                        <div class="kpi-label">30-Day Readmission</div>
                        <div class="kpi-value">8.2%</div>
                        <div class="kpi-subtitle">% of Discharges</div>
                    </div>
                </div>

                <div class="chart-grid">
                    <div class="chart-container">
                        <div class="chart-title">Patient Satisfaction Trend</div>
                        <canvas id="satisfactionChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <div class="chart-title">Appointments by Status</div>
                        <canvas id="statusChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <div id="access" class="tab-content">
            <div class="filter-sidebar">
                <h3>üîç Filters</h3>
                
                <div class="filter-group">
                    <label class="filter-label">Year</label>
                    <select class="filter-select filter-year" multiple>
                        <option value="all" selected>All Years</option>
                        <option value="2023">2023</option>
                        <option value="2024">2024</option>
                        <option value="2025">2025</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label class="filter-label">Specialty</label>
                    <select class="filter-select filter-specialty" multiple>
                        <option value="all" selected>All Specialties</option>
                        <option value="cardiology">Cardiology</option>
                        <option value="orthopedics">Orthopedics</option>
                        <option value="neurology">Neurology</option>
                        <option value="oncology">Oncology</option>
                        <option value="pediatrics">Pediatrics</option>
                        <option value="primary">Primary Care</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label class="filter-label">Region</label>
                    <select class="filter-select filter-region" multiple>
                        <option value="all" selected>All Regions</option>
                        <option value="northeast">Northeast</option>
                        <option value="southeast">Southeast</option>
                        <option value="midwest">Midwest</option>
                        <option value="southwest">Southwest</option>
                        <option value="west">West</option>
                    </select>
                </div>
            </div>
            
            <div class="content-area">
                <div class="kpi-grid">
                    <div class="kpi-card blue">
                        <div class="kpi-label">Total Appointments</div>
                        <div class="kpi-value">15,847</div>
                        <div class="kpi-subtitle">2023-2025</div>
                    </div>
                    <div class="kpi-card green">
                        <div class="kpi-label">Completion Rate</div>
                        <div class="kpi-value">78.5%</div>
                        <div class="kpi-subtitle">% Completed</div>
                    </div>
                    <div class="kpi-card red">
                        <div class="kpi-label">Cancellation Rate</div>
                        <div class="kpi-value">12.3%</div>
                        <div class="kpi-subtitle">% Cancelled</div>
                    </div>
                    <div class="kpi-card amber">
                        <div class="kpi-label">No-Show Rate</div>
                        <div class="kpi-value">9.2%</div>
                        <div class="kpi-subtitle">% No-Shows</div>
                    </div>
                </div>

                <div class="chart-grid">
                    <div class="chart-container">
                        <div class="chart-title">Wait Time Distribution</div>
                        <canvas id="waitTimeChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <div class="chart-title">Cancellation Reasons</div>
                        <canvas id="cancelChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <div id="cost" class="tab-content">
            <div class="filter-sidebar">
                <h3>üîç Filters</h3>
                
                <div class="filter-group">
                    <label class="filter-label">Year</label>
                    <select class="filter-select filter-year" multiple>
                        <option value="all" selected>All Years</option>
                        <option value="2023">2023</option>
                        <option value="2024">2024</option>
                        <option value="2025">2025</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label class="filter-label">Specialty</label>
                    <select class="filter-select filter-specialty" multiple>
                        <option value="all" selected>All Specialties</option>
                        <option value="cardiology">Cardiology</option>
                        <option value="orthopedics">Orthopedics</option>
                        <option value="neurology">Neurology</option>
                        <option value="oncology">Oncology</option>
                        <option value="pediatrics">Pediatrics</option>
                        <option value="primary">Primary Care</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label class="filter-label">Region</label>
                    <select class="filter-select filter-region" multiple>
                        <option value="all" selected>All Regions</option>
                        <option value="northeast">Northeast</option>
                        <option value="southeast">Southeast</option>
                        <option value="midwest">Midwest</option>
                        <option value="southwest">Southwest</option>
                        <option value="west">West</option>
                    </select>
                </div>
            </div>
            
            <div class="content-area">
                <div class="kpi-grid">
                    <div class="kpi-card blue">
                        <div class="kpi-label">Total Charges</div>
                        <div class="kpi-value">$42.3M</div>
                        <div class="kpi-subtitle">All Bills</div>
                    </div>
                    <div class="kpi-card green">
                        <div class="kpi-label">Insurance Paid</div>
                        <div class="kpi-value">$34.8M</div>
                        <div class="kpi-subtitle">Coverage Amount</div>
                    </div>
                    <div class="kpi-card red">
                        <div class="kpi-label">Denial Rate</div>
                        <div class="kpi-value">7.4%</div>
                        <div class="kpi-subtitle">% Denied Claims</div>
                    </div>
                    <div class="kpi-card amber">
                        <div class="kpi-label">Appeal Rate</div>
                        <div class="kpi-value">3.2%</div>
                        <div class="kpi-subtitle">% Appealed</div>
                    </div>
                </div>

                <div class="chart-grid">
                    <div class="chart-container">
                        <div class="chart-title">Out-of-Pocket by Insurance Type</div>
                        <canvas id="oopChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <div class="chart-title">Cost Distribution</div>
                        <canvas id="costChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <div id="satisfaction" class="tab-content">
            <div class="filter-sidebar">
                <h3>üîç Filters</h3>
                
                <div class="filter-group">
                    <label class="filter-label">Year</label>
                    <select class="filter-select filter-year" multiple>
                        <option value="all" selected>All Years</option>
                        <option value="2023">2023</option>
                        <option value="2024">2024</option>
                        <option value="2025">2025</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label class="filter-label">Specialty</label>
                    <select class="filter-select filter-specialty" multiple>
                        <option value="all" selected>All Specialties</option>
                        <option value="cardiology">Cardiology</option>
                        <option value="orthopedics">Orthopedics</option>
                        <option value="neurology">Neurology</option>
                        <option value="oncology">Oncology</option>
                        <option value="pediatrics">Pediatrics</option>
                        <option value="primary">Primary Care</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label class="filter-label">Region</label>
                    <select class="filter-select filter-region" multiple>
                        <option value="all" selected>All Regions</option>
                        <option value="northeast">Northeast</option>
                        <option value="southeast">Southeast</option>
                        <option value="midwest">Midwest</option>
                        <option value="southwest">Southwest</option>
                        <option value="west">West</option>
                    </select>
                </div>
            </div>
            
            <div class="content-area">
                <div class="kpi-grid">
                    <div class="kpi-card green">
                        <div class="kpi-label">Trust Score</div>
                        <div class="kpi-value">8.7</div>
                        <div class="kpi-subtitle">Out of 10</div>
                    </div>
                    <div class="kpi-card blue">
                        <div class="kpi-label">Communication Score</div>
                        <div class="kpi-value">8.2</div>
                        <div class="kpi-subtitle">Out of 10</div>
                    </div>
                    <div class="kpi-card amber">
                        <div class="kpi-label">Total Complaints</div>
                        <div class="kpi-value">342</div>
                        <div class="kpi-subtitle">Filed</div>
                    </div>
                    <div class="kpi-card green">
                        <div class="kpi-label">Resolution Rate</div>
                        <div class="kpi-value">91.5%</div>
                        <div class="kpi-subtitle">% Resolved</div>
                    </div>
                </div>

                <div class="chart-grid">
                    <div class="chart-container">
                        <div class="chart-title">Survey Scores Comparison</div>
                        <canvas id="surveyChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <div class="chart-title">Complaint Categories</div>
                        <canvas id="complaintChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Store chart instances globally
        let chartInstances = {};
        
        // Sample data structure (simulating filtered data)
        const sampleData = {
            all: {
                hcahps: 8.4,
                waitTime: 12,
                outOfPocket: 487,
                readmission: 8.2,
                totalAppts: 15847,
                completionRate: 78.5,
                cancellationRate: 12.3,
                noShowRate: 9.2,
                monthlyScores: [8.1, 8.3, 8.2, 8.4, 8.5, 8.6, 8.4, 8.7, 8.5, 8.6, 8.4, 8.5],
                statusData: [78.5, 12.3, 9.2, 0],
                waitTimeData: [3200, 5400, 4800, 2100, 347],
                trustScore: 8.7,
                commScore: 8.2
            },
            cardiology: {
                hcahps: 8.8,
                waitTime: 15,
                outOfPocket: 620,
                readmission: 6.5,
                totalAppts: 2847,
                completionRate: 82.1,
                cancellationRate: 10.2,
                noShowRate: 7.7,
                monthlyScores: [8.5, 8.6, 8.7, 8.8, 8.9, 9.0, 8.8, 9.1, 8.9, 9.0, 8.8, 8.9],
                statusData: [82.1, 10.2, 7.7, 0],
                waitTimeData: [480, 920, 850, 480, 117],
                trustScore: 9.1,
                commScore: 8.6
            },
            orthopedics: {
                hcahps: 8.2,
                waitTime: 18,
                outOfPocket: 890,
                readmission: 7.8,
                totalAppts: 3142,
                completionRate: 75.3,
                cancellationRate: 15.1,
                noShowRate: 9.6,
                monthlyScores: [7.9, 8.0, 8.1, 8.2, 8.3, 8.4, 8.2, 8.5, 8.3, 8.4, 8.2, 8.3],
                statusData: [75.3, 15.1, 9.6, 0],
                waitTimeData: [520, 880, 1050, 580, 112],
                trustScore: 8.4,
                commScore: 8.0
            },
            primary: {
                hcahps: 8.5,
                waitTime: 5,
                outOfPocket: 125,
                readmission: 3.2,
                totalAppts: 5420,
                completionRate: 85.2,
                cancellationRate: 8.5,
                noShowRate: 6.3,
                monthlyScores: [8.2, 8.4, 8.3, 8.5, 8.6, 8.7, 8.5, 8.8, 8.6, 8.7, 8.5, 8.6],
                statusData: [85.2, 8.5, 6.3, 0],
                waitTimeData: [2150, 1820, 980, 380, 90],
                trustScore: 8.9,
                commScore: 8.7
            }
        };

        // Tab switching functionality
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', function() {
                const targetTab = this.getAttribute('data-tab');
                
                // Remove active class from all tabs and contents
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                
                // Add active class to clicked tab and corresponding content
                this.classList.add('active');
                document.getElementById(targetTab).classList.add('active');
            });
        });

        // Initialize or update charts with data
        function updateCharts(data) {
            // Destroy existing charts before creating new ones
            Object.values(chartInstances).forEach(chart => {
                if (chart) chart.destroy();
            });
            
            // Satisfaction Trend Chart
            chartInstances.satisfactionChart = new Chart(document.getElementById('satisfactionChart'), {
                type: 'line',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                    datasets: [{
                        label: 'HCAHPS Score',
                        data: data.monthlyScores,
                        borderColor: '#0078D4',
                        backgroundColor: 'rgba(0, 120, 212, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    plugins: { legend: { display: false } },
                    scales: { y: { beginAtZero: false, min: 7, max: 10 } }
                }
            });

            // Status Chart
            chartInstances.statusChart = new Chart(document.getElementById('statusChart'), {
                type: 'doughnut',
                data: {
                    labels: ['Completed', 'Cancelled', 'No-Show', 'Pending'],
                    datasets: [{
                        data: data.statusData,
                        backgroundColor: ['#003049', '#d62828', '#f77f00', '#fcbf49']
                    }]
                },
                options: {
                    responsive: true,
                    plugins: { legend: { position: 'bottom' } }
                }
            });

            // Wait Time Chart
            chartInstances.waitTimeChart = new Chart(document.getElementById('waitTimeChart'), {
                type: 'bar',
                data: {
                    labels: ['0-7 days', '8-14 days', '15-30 days', '31-60 days', '60+ days'],
                    datasets: [{
                        label: 'Appointments',
                        data: data.waitTimeData,
                        backgroundColor: ['#ffba08', '#faa307', '#f48c06', '#e85d04', '#d00000']
                    }]
                },
                options: {
                    responsive: true,
                    plugins: { legend: { display: false } }
                }
            });

            // Cancel Reasons Chart
            chartInstances.cancelChart = new Chart(document.getElementById('cancelChart'), {
                type: 'pie',
                data: {
                    labels: ['Patient Request', 'Provider Unavailable', 'Emergency', 'Insurance Issue'],
                    datasets: [{
                        data: [45, 25, 18, 12],
                        backgroundColor: ['#22223b', '#4a4e69', '#9a8c98', '#c9ada7']
                    }]
                },
                options: {
                    responsive: true,
                    plugins: { legend: { position: 'bottom' } }
                }
            });

            // OOP Chart
            chartInstances.oopChart = new Chart(document.getElementById('oopChart'), {
                type: 'bar',
                data: {
                    labels: ['Private', 'Medicare', 'Medicaid', 'Self-Pay'],
                    datasets: [{
                        label: 'Average OOP ($)',
                        data: [520, 380, 240, 890],
                        backgroundColor: ['#e63946', '#a8dadc', '#457b9d', '#1d3557']
                    }]
                },
                options: {
                    responsive: true,
                    plugins: { legend: { display: false } }
                }
            });

            // Cost Distribution Chart
            chartInstances.costChart = new Chart(document.getElementById('costChart'), {
                type: 'bar',
                data: {
                    labels: ['$0-500', '$501-1000', '$1001-2500', '$2501-5000', '$5000+'],
                    datasets: [{
                        label: 'Bills',
                        data: [4200, 3800, 2100, 890, 320],
                        backgroundColor: ['#fefae0', '#dda15e', '#bc6c25', '#606c38', '#283618']
                    }]
                },
                options: {
                    responsive: true,
                    plugins: { legend: { display: false } }
                }
            });

            // Survey Scores Chart
            chartInstances.surveyChart = new Chart(document.getElementById('surveyChart'), {
                type: 'bar',
                data: {
                    labels: ['HCAHPS', 'Trust', 'Communication'],
                    datasets: [{
                        label: 'Score',
                        data: [data.hcahps, data.trustScore, data.commScore],
                        backgroundColor: ['#8ecae6', '#219ebc', '#023047']
                    }]
                },
                options: {
                    responsive: true,
                    plugins: { legend: { display: false } },
                    scales: { y: { beginAtZero: false, min: 7, max: 10 } }
                }
            });

            // Complaint Categories Chart
            chartInstances.complaintChart = new Chart(document.getElementById('complaintChart'), {
                type: 'pie',
                data: {
                    labels: ['Wait Time', 'Billing', 'Communication', 'Quality', 'Access'],
                    datasets: [{
                        data: [32, 28, 18, 14, 8],
                        backgroundColor: ['#e63946', '#f1faee', '#a8dadc', '#457b9d', '#1d3557']
                    }]
                },
                options: {
                    responsive: true,
                    plugins: { legend: { position: 'bottom' } }
                }
            });
        }

        // Initialize charts when page loads
        window.addEventListener('load', function() {
            updateCharts(sampleData.all);
        });

        // Multi-select filter functionality with cross-tab sync
        document.addEventListener('DOMContentLoaded', function() {
            // Global filter state
            const filterState = {
                year: ['all'],
                specialty: ['all'],
                region: ['all']
            };
            
            // Setup all filter selects
            setupFilters();
            
            function setupFilters() {
                // Get all filter selects by class
                const yearSelects = document.querySelectorAll('.filter-year');
                const specialtySelects = document.querySelectorAll('.filter-specialty');
                const regionSelects = document.querySelectorAll('.filter-region');
                
                // Attach handlers to all year filters
                yearSelects.forEach(select => {
                    select.addEventListener('change', function(e) {
                        handleFilterChange(this, 'year', yearSelects);
                    });
                });
                
                // Attach handlers to all specialty filters
                specialtySelects.forEach(select => {
                    select.addEventListener('change', function(e) {
                        handleFilterChange(this, 'specialty', specialtySelects);
                    });
                });
                
                // Attach handlers to all region filters
                regionSelects.forEach(select => {
                    select.addEventListener('change', function(e) {
                        handleFilterChange(this, 'region', regionSelects);
                    });
                });
            }
            
            function handleFilterChange(changedSelect, filterType, allSelects) {
                const options = Array.from(changedSelect.options);
                const allOption = options.find(opt => opt.value === 'all');
                const selectedValues = options.filter(opt => opt.selected && opt.value !== 'all').map(opt => opt.value);
                
                // Handle "All" logic
                if (allOption && allOption.selected && selectedValues.length > 0) {
                    options.forEach(opt => {
                        if (opt.value !== 'all') opt.selected = false;
                    });
                    filterState[filterType] = ['all'];
                } else if (selectedValues.length > 0) {
                    if (allOption) allOption.selected = false;
                    filterState[filterType] = selectedValues;
                } else {
                    if (allOption) allOption.selected = true;
                    filterState[filterType] = ['all'];
                }
                
                // Sync all selects of this type across tabs
                syncFilters(allSelects, filterState[filterType]);
                
                // Apply filters to dashboard
                applyFilters();
            }
            
            function syncFilters(selects, selectedValues) {
                selects.forEach(select => {
                    Array.from(select.options).forEach(opt => {
                        opt.selected = selectedValues.includes(opt.value);
                    });
                });
            }
            
            function applyFilters() {
                console.log('Filters applied across all tabs:', filterState);
                
                // Visual feedback
                const contentAreas = document.querySelectorAll('.content-area');
                contentAreas.forEach(area => {
                    area.style.opacity = '0.7';
                    setTimeout(() => {
                        area.style.opacity = '1';
                    }, 200);
                });
                
                // In production, this would:
                // 1. Filter the actual data based on filterState
                // 2. Update all charts across all tabs
                // 3. Recalculate KPI values
                // 4. Refresh visualizations
            }
        });
    </script>
</body>
</html>